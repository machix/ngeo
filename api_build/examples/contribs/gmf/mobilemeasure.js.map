{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./contribs/gmf/examples/mobilemeasure.js","webpack:///./contribs/gmf/src/mobile/measure/lengthComponent.html","webpack:///./contribs/gmf/src/mobile/measure/lengthComponent.js","webpack:///./contribs/gmf/src/mobile/measure/pointComponent.html","webpack:///./contribs/gmf/src/mobile/measure/pointComponent.js","webpack:///./src/interaction/MeasureLengthMobile.js","webpack:///./src/interaction/MeasurePointMobile.js","webpack:///./src/interaction/MobileDraw.js"],"names":["exports","module","angular","gmfMapComponent","name","gmfPermalinkPermalink","gmfMobileMeasureLengthComponent","gmfMobileMeasurePointComponent","ngeoMiscBtnComponent","value","appURL","RASTER","constant","MainController","gmfPermalink","center","getMapCenter","zoom","getMapZoom","map","olMap","layers","olLayerTile","source","olSourceOSM","view","olView","projection","EPSG21781","resolutions","addControl","olControlScaleLine","measureLengthActive","measurePointLayersConfig","unit","decimals","measurePointActive","controller","ngeoMiscFilters","element","attrs","templateUrl","undefined","run","$templateCache","put","require","component_","gmfMobileMeasureLengthTemplateUrl","restrict","scope","bindToController","link","init","directive","Controller_","$scope","$filter","gettextCatalog","scope_","filter_","gettextCatalog_","active","$watch","newVal","measure","setActive","precision","sketchStyle","olStyleStyle","fill","olStyleFill","color","stroke","olStyleStroke","lineDash","width","image","olStyleRegularShape","points","radius","radius2","angle","drawInteraction","dirty","drawing","valid","prototype","ngeoInteractionMeasureLengthMobile","ngeoMiscDecorate","interaction","getDrawInteraction","Object","defineProperty","get","getFeature","olEvents","getDirty","$apply","getDrawing","getValid","addInteraction","addPoint","addToDrawing","clear","clearDrawing","finish","finishDrawing","deactivate","gmfRasterRasterService","ngeoMiscDebounce","gmfMobileMeasurePointTemplateUrl","gmfRaster","ngeoDebounce","gmfRaster_","ngeoDebounce_","$filter_","handleMeasureActiveChange_","coordinateDecimalsFn","coordinateDecimals","layersConfig","format","mapViewPropertyChangeEventKey_","ngeoInteractionMeasurePointMobile","googAsserts","assert","Array","isArray","translate","str","getString","getActive","getView","getMeasure_","bind","getCenter","assertArray","params","config","join","getRaster","then","object","el","getTooltipElement","ctn","document","createElement","className","key","childEl","innerHTML","appendChild","previousCtn","getElementsByClassName","remove","LayerConfig","opt_options","options","assign","displayHelpTooltip","ngeoInteractionMeasureLength","call","olUtilInherits","createDrawInteraction","style","ngeoInteractionMobileDraw","type","coordFormat","ngeoInteractionMeasure","format_","coordFormat_","handleMeasure","callback","geom","assertInstanceof","sketchFeature","getGeometry","olGeomPoint","dec","output","getFormattedPoint","coord","getLastCoordinate","olInteractionInteraction","handleEvent","olFunctions","TRUE","changeEventKey_","type_","minPoints_","minPoints","sketchFeature_","sketchPoints_","sketchPoint_","overlay_","olLayerVector","olSourceVector","useSpatialIndex","wrapX","ngeoInteractionCommon","getDefaultDrawStyleFunction","updateWhileAnimating","updateWhileInteracting","updateState_","set","setMap","currentMap","getMap","handleViewCenterChange_","sketchFeatureGeom","sketchPointGeom","getSketchPointGeometry_","coordinate","getCoordinates","coordinates","olFeature","event","ngeoCustomEvent","feature","dispatchEvent","olGeomSimpleGeometry","setCoordinates","push","slice","olGeomLineString","length","updateSketchFeatures_","startDrawing_","createOrUpdateSketchPoint_","modifyDrawing_","getCenter_","pop","abortDrawing_","getSource","evt","geometry","sketchFeatures","overlaySource","addFeatures"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACnJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAMA,OAAO,GAAG,EAAhB;AAEA;AACA;AAEA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIAA,OAAO,CAACC,MAAR,GAAiBC,OAAO,CAACD,MAAR,CAAe,QAAf,EAAyB,CACxC,SADwC,EAExCE,4DAAe,CAACC,IAFwB,EAGxCC,kEAAqB,CAACJ,MAAtB,CAA6BG,IAHW,EAIxCE,6EAA+B,CAACF,IAJQ,EAK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","file":"mobilemeasure.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"mobilemeasure\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([16,\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * @module gmfapp.mobilemeasure\n */\nconst exports = {};\n\nimport appURL from './url.js';\nimport './mobilemeasure.css';\n/** @suppress {extraRequire} */\nimport gmfMapComponent from 'gmf/map/component.js';\n\n/** @suppress {extraRequire} */\nimport gmfPermalinkPermalink from 'gmf/permalink/Permalink.js';\n\nimport gmfMobileMeasureLengthComponent from 'gmf/mobile/measure/lengthComponent.js';\nimport gmfMobileMeasurePointComponent from 'gmf/mobile/measure/pointComponent.js';\nimport ngeoMiscBtnComponent from 'ngeo/misc/btnComponent.js';\nimport EPSG21781 from '@geoblocks/proj/src/EPSG_21781.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport olControlScaleLine from 'ol/control/ScaleLine.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olSourceOSM from 'ol/source/OSM.js';\n\n\n/** @type {!angular.IModule} **/\nexports.module = angular.module('gmfapp', [\n  'gettext',\n  gmfMapComponent.name,\n  gmfPermalinkPermalink.module.name,\n  gmfMobileMeasureLengthComponent.name,\n  gmfMobileMeasurePointComponent.name,\n  ngeoMiscBtnComponent.name,\n]);\n\n\nexports.module.value('gmfRasterUrl', appURL.RASTER);\n\nexports.module.constant('defaultTheme', 'Demo');\nexports.module.constant('angularLocaleScript', '../build/angular-locale_{{locale}}.js');\n\n\n/**\n * @param {gmf.permalink.Permalink} gmfPermalink The gmf permalink service.\n * @constructor\n * @ngInject\n */\nexports.MainController = function(gmfPermalink) {\n\n  const center = gmfPermalink.getMapCenter() || [537635, 152640];\n  const zoom = gmfPermalink.getMapZoom() || 3;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      })\n    ],\n    view: new olView({\n      projection: EPSG21781,\n      resolutions: [200, 100, 50, 20, 10, 5, 2.5, 2, 1, 0.5],\n      center: center,\n      zoom: zoom\n    })\n  });\n\n  this.map.addControl(new olControlScaleLine());\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.measureLengthActive = false;\n\n  /**\n   * @type {Object.<string, gmf.mobile.measure.pointComponent.LayerConfig>}\n   * @export\n   */\n  this.measurePointLayersConfig = [\n    {name: 'aster', unit: 'm', decimals: 2},\n    {name: 'srtm', unit: 'm'}\n  ];\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.measurePointActive = false;\n\n};\n\n\nexports.module.controller('MainController', exports.MainController);\n\n\nexport default exports;\n","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.drawing && (!ctrl.valid)\"\\n   ng-click=\"ctrl.addPoint()\">\\n     <span class=\"fa fa-check\"></span>\\n     {{\\'Set as starting point\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.dirty\"\\n   ng-click=\"ctrl.addPoint()\">\\n     <span class=\"fa fa-plus\"></span>\\n     {{\\'Add new point\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.drawing && ctrl.valid && !ctrl.dirty\"\\n   ng-click=\"ctrl.finish()\">\\n     <span class=\"fa fa-check\"></span>\\n     {{\\'Terminate\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.valid\"\\n   ng-click=\"ctrl.clear()\">\\n     <span class=\"fa fa-repeat\"></span>\\n     {{\\'Clear\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.active\"\\n   ng-click=\"ctrl.deactivate()\">\\n     <span class=\"fa fa-times\"></span>\\n     {{\\'Close\\' | translate}}\\n</a>\\n';\n\n}\nreturn __p\n}","/**\n * @module gmf.mobile.measure.lengthComponent\n */\nimport ngeoMiscFilters from 'ngeo/misc/filters.js';\nimport ngeoInteractionMeasureLengthMobile from 'ngeo/interaction/MeasureLengthMobile.js';\nimport ngeoMiscDecorate from 'ngeo/misc/decorate.js';\nimport * as olEvents from 'ol/events.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleRegularShape from 'ol/style/RegularShape.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olStyleStyle from 'ol/style/Style.js';\n\nconst exports = angular.module('gmfMobileMeasureLength', [\n  ngeoMiscFilters.name,\n]);\n\n\nexports.value('gmfMobileMeasureLengthTemplateUrl',\n  /**\n   * @param {angular.JQLite} element Element.\n   * @param {angular.Attributes} attrs Attributes.\n   * @return {string} The template url.\n   */\n  (element, attrs) => {\n    const templateUrl = attrs['gmfMobileMeasureLengthTemplateurl'];\n    return templateUrl !== undefined ? templateUrl :\n      'gmf/measure/lengthComponent';\n  });\n\nexports.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/measure/lengthComponent', require('./lengthComponent.html'));\n});\n\n\n/**\n * Provide a directive to do a length measure on the mobile devices.\n *\n * Example:\n *\n *      <div gmf-mobile-measurelength\n *        gmf-mobile-measurelength-active=\"ctrl.measureLengthActive\"\n *        gmf-mobile-measurelength-map=\"::ctrl.map\">\n *      </div>\n *\n * @htmlAttribute {boolean} gmf-mobile-measurelength-active Used to active\n * or deactivate the component.\n * @htmlAttribute {number=} gmf-mobile-measurelength-precision the number of significant digits to display.\n * @htmlAttribute {ol.Map} gmf-mobile-measurelength-map The map.\n * @htmlAttribute {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction=}\n *     gmf-mobile-measurelength-sketchstyle A style for the measure length.\n * @param {string|function(!angular.JQLite=, !angular.Attributes=)}\n *     gmfMobileMeasureLengthTemplateUrl Template URL for the directive.\n * @return {angular.IDirective} The Directive Definition Object.\n * @ngInject\n * @ngdoc directive\n * @ngname gmfMobileMeasureLength\n */\nexports.component_ =\n    function(gmfMobileMeasureLengthTemplateUrl) {\n      return {\n        restrict: 'A',\n        scope: {\n          'active': '=gmfMobileMeasurelengthActive',\n          'precision': '<?gmfMobileMeasurelengthPrecision',\n          'map': '=gmfMobileMeasurelengthMap',\n          'sketchStyle': '=?gmfMobileMeasurelengthSketchstyle'\n        },\n        controller: 'GmfMobileMeasureLengthController as ctrl',\n        bindToController: true,\n        templateUrl: gmfMobileMeasureLengthTemplateUrl,\n        /**\n         * @param {angular.IScope} scope Scope.\n         * @param {angular.JQLite} element Element.\n         * @param {angular.Attributes} attrs Attributes.\n         * @param {gmf.mobile.measure.lengthComponent.Controller_} controller Controller.\n         */\n        link: (scope, element, attrs, controller) => {\n          controller.init();\n        }\n      };\n    };\n\n\nexports.directive('gmfMobileMeasurelength',\n  exports.component_);\n\n\n/**\n * @param {!angular.IScope} $scope Angular scope.\n * @param {!angular.IFilterService} $filter Angular filter\n * @param {!angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @constructor\n * @private\n * @struct\n * @ngInject\n * @ngdoc controller\n * @ngname GmfMobileMeasureLengthController\n */\nexports.Controller_ = function($scope, $filter, gettextCatalog) {\n\n  /**\n   * @type {angular.IScope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {angular.IFilterService}\n   * @private\n   */\n  this.filter_ = $filter;\n\n  /**\n   * @type {!angularGettext.Catalog}\n   * @private\n   */\n  this.gettextCatalog_ = gettextCatalog;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  this.scope_.$watch(() => this.active, (newVal) => {\n    this.measure.setActive(newVal);\n  });\n\n  /**\n   * @type {number|undefined}\n   * @export\n   */\n  this.precision;\n\n  /**\n   * @type {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction}\n   * @export\n   */\n  this.sketchStyle = new olStyleStyle({\n    fill: new olStyleFill({\n      color: 'rgba(255, 255, 255, 0.2)'\n    }),\n    stroke: new olStyleStroke({\n      color: 'rgba(0, 0, 0, 0.5)',\n      lineDash: [10, 10],\n      width: 2\n    }),\n    image: new olStyleRegularShape({\n      stroke: new olStyleStroke({\n        color: 'rgba(0, 0, 0, 0.7)',\n        width: 2\n      }),\n      points: 4,\n      radius: 8,\n      radius2: 0,\n      angle: 0\n    })\n  });\n\n  /**\n   * @type {ngeo.interaction.MeasureLengthMobile}\n   * @export\n   */\n  this.measure;\n\n  /**\n   * @type {ngeo.interaction.MobileDraw}\n   * @export\n   */\n  this.drawInteraction;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.dirty = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.drawing = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.valid = false;\n};\n\n/**\n * Initialise the controller.\n */\nexports.Controller_.prototype.init = function() {\n\n  this.measure = new ngeoInteractionMeasureLengthMobile(this.filter_('ngeoUnitPrefix'), this.gettextCatalog_, {\n    precision: this.precision,\n    sketchStyle: this.sketchStyle\n  });\n\n  this.measure.setActive(this.active);\n  ngeoMiscDecorate.interaction(this.measure);\n\n\n  this.drawInteraction = /** @type {ngeo.interaction.MobileDraw} */ (\n    this.measure.getDrawInteraction());\n\n  const drawInteraction = this.drawInteraction;\n  ngeoMiscDecorate.interaction(drawInteraction);\n\n  Object.defineProperty(this, 'hasPoints', {\n    get() {\n      return this.drawInteraction.getFeature() !== null;\n    }\n  });\n\n  olEvents.listen(\n    drawInteraction,\n    'change:dirty',\n    function() {\n      this.dirty = drawInteraction.getDirty();\n\n      // this is where the angular scope is forced to be applied. We\n      // only need to do this when dirty, as going to \"no being dirty\"\n      // is made by a click on a button where Angular is within scope\n      if (this.dirty) {\n        this.scope_.$apply();\n      }\n    },\n    this\n  );\n\n  olEvents.listen(\n    drawInteraction,\n    'change:drawing',\n    function() {\n      this.drawing = drawInteraction.getDrawing();\n    },\n    this\n  );\n\n  olEvents.listen(\n    drawInteraction,\n    'change:valid',\n    function() {\n      this.valid = drawInteraction.getValid();\n    },\n    this\n  );\n\n  this.map.addInteraction(this.measure);\n};\n\n/**\n * Add current sketch point to line measure\n * @export\n */\nexports.Controller_.prototype.addPoint = function() {\n  this.drawInteraction.addToDrawing();\n};\n\n\n/**\n * Clear the sketch feature\n * @export\n */\nexports.Controller_.prototype.clear = function() {\n  this.drawInteraction.clearDrawing();\n};\n\n\n/**\n * Finish line measure\n * @export\n */\nexports.Controller_.prototype.finish = function() {\n  this.drawInteraction.finishDrawing();\n};\n\n\n/**\n * Deactivate the directive.\n * @export\n */\nexports.Controller_.prototype.deactivate = function() {\n  this.active = false;\n};\n\n\nexports.controller('GmfMobileMeasureLengthController',\n  exports.Controller_);\n\n\nexport default exports;\n","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.active\"\\n   ng-click=\"ctrl.deactivate()\">\\n     <span class=\"fa fa-times\"></span>\\n     {{\\'Close\\' | translate}}\\n</a>\\n';\n\n}\nreturn __p\n}","/**\n * @module gmf.mobile.measure.pointComponent\n */\nimport gmfRasterRasterService from 'gmf/raster/RasterService.js';\nimport googAsserts from 'goog/asserts.js';\nimport ngeoInteractionMeasurePointMobile from 'ngeo/interaction/MeasurePointMobile.js';\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\nimport ngeoMiscDecorate from 'ngeo/misc/decorate.js';\nimport * as olEvents from 'ol/events.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleRegularShape from 'ol/style/RegularShape.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olStyleStyle from 'ol/style/Style.js';\n\nconst exports = angular.module('gmfMobileMeasurePoint', [\n  gmfRasterRasterService.module.name,\n  ngeoMiscDebounce.name,\n]);\n\n\nexports.value('gmfMobileMeasurePointTemplateUrl',\n  /**\n   * @param {angular.JQLite} element Element.\n   * @param {angular.Attributes} attrs Attributes.\n   * @return {string} The template url.\n   */\n  (element, attrs) => {\n    const templateUrl = attrs['gmfMobileMeasurePointTemplateurl'];\n    return templateUrl !== undefined ? templateUrl :\n      'gmf/measure/pointComponent';\n  });\n\nexports.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/measure/pointComponent', require('./pointComponent.html'));\n});\n\n\n/**\n * Provide a directive to do a point (coordinate and elevation) measure on the\n * mobile devices.\n *\n * Example:\n *\n *      <div gmf-mobile-measurepoint\n *        gmf-mobile-measurepoint-active=\"ctrl.measurePointActive\"\n *        gmf-mobile-measurepoint-layersconfig=\"::ctrl.measurePointLayers\"\n *        gmf-mobile-measurepoint-map=\"::ctrl.map\">\n *      </div>\n *\n * Where ctrl.measurePointLayers is an object like this:\n *\n *      this.measurePointLayers = [\n *        {name: 'srtm', unit: 'm', decimals: 2},\n *        {name: 'wind', {unit: 'km/h'},\n *        {name: 'humidity'}\n *      ];\n *\n * @htmlAttribute {boolean} gmf-mobile-measurepoint-active Used to active\n * or deactivate the component.\n * @htmlAttribute {number=} gmf-mobile-measurepoint-coordinatedecimals number\n *     of decimal to display for the coordinate.\n * @htmlAttribute {Array.<gmf.mobile.measure.pointComponent.LayerConfig>}\n *     gmf-mobile-measurepoint-layersconfig Raster elevation layers to get\n *     information under the point and its configuaration.\n * @htmlAttribute {ol.Map} gmf-mobile-measurepoint-map The map.\n * @htmlAttribute {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction=}\n *     gmf-mobile-measurepoint-sketchstyle A style for the measure point.\n * @param {string|function(!angular.JQLite=, !angular.Attributes=)}\n *     gmfMobileMeasurePointTemplateUrl Template URL for the directive.\n * @return {angular.IDirective} The Directive Definition Object.\n * @ngInject\n * @ngdoc directive\n * @ngname gmfMobileMeasurePoint\n */\nexports.component_ =\n    function(gmfMobileMeasurePointTemplateUrl) {\n      return {\n        restrict: 'A',\n        scope: {\n          'active': '=gmfMobileMeasurepointActive',\n          'getCoordinateDecimalsFn': '&?gmfMobileMeasurepointCoordinatedecimals',\n          'getLayersConfigFn': '&gmfMobileMeasurepointLayersconfig',\n          'map': '=gmfMobileMeasurepointMap',\n          'sketchStyle': '=?gmfMobileMeasurepointSketchstyle',\n          'format': '<gmfMobileMeasurepointFormat'\n        },\n        controller: 'GmfMobileMeasurePointController as ctrl',\n        bindToController: true,\n        templateUrl: gmfMobileMeasurePointTemplateUrl,\n        /**\n         * @param {!angular.IScope} scope Scope.\n         * @param {!angular.JQLite} element Element.\n         * @param {!angular.Attributes} attrs Attributes.\n         * @param {!gmf.mobile.measure.pointComponent.Controller_} controller Controller.\n         */\n        link: (scope, element, attrs, controller) => {\n          controller.init();\n        }\n      };\n    };\n\n\nexports.directive('gmfMobileMeasurepoint',\n  exports.component_);\n\n\n/**\n * @param {angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @param {!angular.IScope} $scope Angular scope.\n * @param {angular.IFilterService} $filter Angular filter service.\n * @param {gmf.raster.RasterService} gmfRaster gmf Raster service.\n * @param {ngeox.miscDebounce} ngeoDebounce ngeo Debounce factory.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname GmfMobileMeasurePointController\n */\nexports.Controller_ = function(gettextCatalog, $scope, $filter,\n  gmfRaster, ngeoDebounce) {\n\n  /**\n   * @type {gmf.raster.RasterService}\n   * @private\n   */\n  this.gmfRaster_ = gmfRaster;\n\n  /**\n   * @type {ngeox.miscDebounce}\n   * @private\n   */\n  this.ngeoDebounce_ = ngeoDebounce;\n\n  /**\n   * @type {angularGettext.Catalog}\n   * @private\n   */\n  this.gettextCatalog_ = gettextCatalog;\n\n  /**\n   * @type {angular.IFilterService}\n   * @private\n   */\n  this.$filter_ = $filter;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  $scope.$watch(() => this.active, (newVal) => {\n    this.measure.setActive(newVal);\n    this.handleMeasureActiveChange_();\n  });\n\n  const coordinateDecimalsFn = this['getCoordinateDecimalsFn'];\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.coordinateDecimals = coordinateDecimalsFn ? coordinateDecimalsFn() : 0;\n\n  /**\n   * @type {!Array.<gmf.mobile.measure.pointComponent.LayerConfig>}\n   * @private\n   */\n  this.layersConfig;\n\n  /**\n   * @type {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction}\n   * @export\n   */\n  this.sketchStyle;\n\n  if (this.sketchStyle === undefined) {\n    this.sketchStyle = new olStyleStyle({\n      fill: new olStyleFill({\n        color: 'rgba(255, 255, 255, 0.2)'\n      }),\n      stroke: new olStyleStroke({\n        color: 'rgba(0, 0, 0, 0.5)',\n        lineDash: [10, 10],\n        width: 2\n      }),\n      image: new olStyleRegularShape({\n        stroke: new olStyleStroke({\n          color: 'rgba(0, 0, 0, 0.7)',\n          width: 2\n        }),\n        points: 4,\n        radius: 8,\n        radius2: 0,\n        angle: 0\n      })\n    });\n  }\n\n  /**\n   * @type {string}\n   */\n  this.format;\n\n  /**\n   * @type {ngeo.interaction.MeasurePointMobile}\n   * @export\n   */\n  this.measure;\n\n  /**\n   * @type {ngeo.interaction.MobileDraw}\n   * @export\n   */\n  this.drawInteraction;\n\n  /**\n   * The key for map view 'propertychange' event.\n   * @type {?ol.EventsKey}\n   * @private\n   */\n  this.mapViewPropertyChangeEventKey_ = null;\n};\n\n\n/**\n * Initialise the controller.\n */\nexports.Controller_.prototype.init = function() {\n  this.measure = new ngeoInteractionMeasurePointMobile(\n    /** @type {ngeox.numberCoordinates} */ (this.$filter_('ngeoNumberCoordinates')),\n    this.format || '{x}, {y}',\n    {\n      decimals: this.coordinateDecimals,\n      sketchStyle: this.sketchStyle\n    }\n  );\n  this.measure.setActive(this.active);\n  ngeoMiscDecorate.interaction(this.measure);\n  this.drawInteraction = /** @type {ngeo.interaction.MobileDraw} */ (this.measure.getDrawInteraction());\n  ngeoMiscDecorate.interaction(this.drawInteraction);\n\n  const layersConfig = this['getLayersConfigFn']();\n  googAsserts.assert(Array.isArray(layersConfig));\n  this.layersConfig = layersConfig;\n\n  this.map.addInteraction(this.measure);\n};\n\n\n/**\n * Deactivate the directive.\n * @export\n */\nexports.Controller_.prototype.deactivate = function() {\n  this.active = false;\n};\n\n\n/**\n * @param {string} str String to translate.\n * @return {string} The translated text.\n * @export\n */\nexports.Controller_.prototype.translate = function(str) {\n  return this.gettextCatalog_.getString(str);\n};\n\n\n/**\n * Called when the measure becomes active or inactive. Act accordingly:\n * - on activate, listen to the map property changes to call for the elevation\n *   service.\n * - on deactivate, unlisten\n * @private\n */\nexports.Controller_.prototype.handleMeasureActiveChange_ = function() {\n  if (this.measure.getActive()) {\n    const view = this.map.getView();\n    this.mapViewPropertyChangeEventKey_ = olEvents.listen(\n      view,\n      'propertychange',\n      this.ngeoDebounce_(\n        this.getMeasure_.bind(this), 300, /* invokeApply */ true),\n      this);\n    this.getMeasure_();\n  } else if (this.mapViewPropertyChangeEventKey_) {\n    olEvents.unlistenByKey(this.mapViewPropertyChangeEventKey_);\n    this.mapViewPropertyChangeEventKey_ = null;\n  }\n};\n\n\n/**\n * Call the elevation service to get information about the measure at\n * the current map center location.\n * @private\n */\nexports.Controller_.prototype.getMeasure_ = function() {\n  const center = this.map.getView().getCenter();\n  googAsserts.assertArray(center);\n  const params = {\n    'layers': this.layersConfig.map(config => config.name).join(',')\n  };\n  this.gmfRaster_.getRaster(center, params).then((object) => {\n    const el = this.measure.getTooltipElement();\n    const ctn = document.createElement('div');\n    const className = 'gmf-mobile-measure-point';\n    ctn.className = className;\n\n    for (const config of this.layersConfig) {\n      const key = config.name;\n      if (key in object) {\n        let value = object[key];\n        const childEl = document.createElement('div');\n        childEl.className = `gmf-mobile-measure-point-${key}`;\n        const unit = config.unit || '';\n        const decimals = config.decimals && config.decimals > 0 || 0;\n        value = this.$filter_('number')(value, decimals);\n        childEl.innerHTML = [this.translate(key), ': ', value, ' ', unit].join('');\n        ctn.appendChild(childEl);\n      }\n    }\n\n    const previousCtn = el.getElementsByClassName(className);\n    if (previousCtn[0]) {\n      previousCtn[0].remove();\n    }\n    el.appendChild(ctn);\n\n  });\n};\n\n\nexports.controller('GmfMobileMeasurePointController',\n  exports.Controller_);\n\n/**\n * @typedef {{\n *     name: string,\n *     decimals: (number|undefined),\n *     unit: (string|undefined)\n * }}\n */\nexports.LayerConfig;\n\n\nexport default exports;\n","/**\n * @module ngeo.interaction.MeasureLengthMobile\n */\nimport ngeoInteractionMeasureLength from 'ngeo/interaction/MeasureLength.js';\nimport ngeoInteractionMobileDraw from 'ngeo/interaction/MobileDraw.js';\nimport {inherits as olUtilInherits} from 'ol/util.js';\n\n/**\n * @classdesc\n * Interaction dedicated to measure length on mobile devices.\n *\n * @constructor\n * @struct\n * @extends {ngeo.interaction.MeasureLength}\n * @param {!ngeox.unitPrefix} format The format function\n * @param {!angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @param {ngeox.interaction.MeasureOptions=} opt_options Options\n */\nconst exports = function(format, gettextCatalog, opt_options) {\n\n  const options = opt_options !== undefined ? opt_options : {};\n\n  Object.assign(options, {displayHelpTooltip: false});\n\n  ngeoInteractionMeasureLength.call(this, format, gettextCatalog, options);\n\n};\n\nolUtilInherits(\n  exports, ngeoInteractionMeasureLength);\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.createDrawInteraction = function(style, source) {\n  return new ngeoInteractionMobileDraw({\n    type: /** @type {ol.geom.GeometryType} */ ('LineString'),\n    style: style,\n    source: source\n  });\n};\n\n\nexport default exports;\n","/**\n * @module ngeo.interaction.MeasurePointMobile\n */\nimport googAsserts from 'goog/asserts.js';\nimport ngeoInteractionMeasure from 'ngeo/interaction/Measure.js';\nimport ngeoInteractionMobileDraw from 'ngeo/interaction/MobileDraw.js';\nimport {inherits as olUtilInherits} from 'ol/util.js';\n\nimport olGeomPoint from 'ol/geom/Point.js';\n\n/**\n * @classdesc\n * Interaction dedicated to measure by coordinate (point) on mobile devices.\n *\n * @constructor\n * @struct\n * @extends {ngeo.interaction.Measure}\n * @param {ngeox.numberCoordinates} format the number formatter\n * @param {string} coordFormat the coordinates formatter\n * @param {ngeox.interaction.MeasureOptions=} options Options\n */\nconst exports = function(format, coordFormat, options = /** @type {ngeox.interaction.MeasureOptions} */ ({})) {\n\n  Object.assign(options, {displayHelpTooltip: false});\n\n  ngeoInteractionMeasure.call(this, /** @type {ngeo.interaction.MeasureBaseOptions} */(options));\n\n  /**\n   * @type {ngeox.numberCoordinates}\n   * @private\n   */\n  this.format_ = format;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.coordFormat_ = coordFormat;\n};\n\nolUtilInherits(exports, ngeoInteractionMeasure);\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.createDrawInteraction = function(style, source) {\n  return new ngeoInteractionMobileDraw({\n    type: /** @type {ol.geom.GeometryType} */ ('Point'),\n    style: style,\n    source: source\n  });\n};\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.handleMeasure = function(callback) {\n  const geom = googAsserts.assertInstanceof(this.sketchFeature.getGeometry(), olGeomPoint);\n  const dec = this.decimals;\n  const output = ngeoInteractionMeasure.getFormattedPoint(geom, dec, this.format_, this.coordFormat_);\n  const coord = geom.getLastCoordinate();\n  callback(output, coord);\n};\n\n\nexport default exports;\n","/**\n * @module ngeo.interaction.MobileDraw\n */\nimport googAsserts from 'goog/asserts.js';\nimport ngeoInteractionCommon from 'ngeo/interaction/common.js';\nimport ngeoCustomEvent from 'ngeo/CustomEvent.js';\nimport {inherits as olUtilInherits} from 'ol/util.js';\nimport * as olEvents from 'ol/events.js';\nimport olFeature from 'ol/Feature.js';\nimport * as olFunctions from 'ol/functions.js';\nimport olGeomLineString from 'ol/geom/LineString.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olGeomSimpleGeometry from 'ol/geom/SimpleGeometry.js';\nimport olInteractionInteraction from 'ol/interaction/Interaction.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olSourceVector from 'ol/source/Vector.js';\n\n/**\n * @classdesc\n * Interaction for drawing feature geometries from a mobile device using the\n * center of the map view as entry for points added.\n *\n * Supports:\n * - point\n * - line string\n *\n * @constructor\n * @struct\n * @fires ngeox.DrawEvent\n * @extends {ol.interaction.Interaction}\n * @param {ngeox.interaction.MobileDrawOptions} options Options\n */\nconst exports = function(options) {\n\n  olInteractionInteraction.call(this, {\n    handleEvent: olFunctions.TRUE\n  });\n\n  /**\n   * The key for view center change event.\n   * @type {?ol.EventsKey}\n   * @private\n   */\n  this.changeEventKey_ = null;\n\n  /**\n   * Geometry type.\n   * @type {ol.geom.GeometryType}\n   * @private\n   */\n  this.type_ = options.type;\n\n  /**\n   * The number of points that must be drawn before a polygon ring or line\n   * string can be finished.  The default is 3 for polygon rings and 2 for\n   * line strings.\n   * @type {number}\n   * @private\n   */\n  this.minPoints_ = options.minPoints ?\n    options.minPoints :\n    (this.type_ === 'Polygon' ? 3 : 2);\n\n  /**\n   * Sketch feature.\n   * @type {ol.Feature}\n   * @private\n   */\n  this.sketchFeature_ = null;\n\n  /**\n   * Previous sketch points, saved to be able to display them on the layer.\n   * @type {Array.<ol.Feature>}\n   * @private\n   */\n  this.sketchPoints_ = [];\n\n  /**\n   * Current sketch point.\n   * @type {ol.Feature}\n   * @private\n   */\n  this.sketchPoint_ = null;\n\n  /**\n   * Draw overlay where our sketch features are drawn.\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.overlay_ = new olLayerVector({\n    source: new olSourceVector({\n      useSpatialIndex: false,\n      wrapX: options.wrapX ? options.wrapX : false\n    }),\n    style: options.style || ngeoInteractionCommon.getDefaultDrawStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  olEvents.listen(this, 'change:active', this.updateState_, this);\n\n  this.set('dirty', false);\n  this.set('drawing', false);\n  this.set('valid', false);\n\n};\n\nolUtilInherits(exports, olInteractionInteraction);\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.setMap = function(map) {\n\n  const currentMap = this.getMap();\n  if (currentMap) {\n    if (this.changeEventKey_) {\n      olEvents.unlistenByKey(this.changeEventKey_);\n    }\n  }\n\n  olInteractionInteraction.prototype.setMap.call(this, map);\n\n  if (map) {\n    this.changeEventKey_ = olEvents.listen(map.getView(),\n      'change:center',\n      this.handleViewCenterChange_, this);\n  }\n\n  this.updateState_();\n};\n\n\n// === PUBLIC METHODS - PROPERTY GETTERS ===\n\n\n/**\n * Return whether the interaction is currently dirty. It is if the sketch\n * feature has its geometry last coordinate set to the center without the\n * use of the `addToDrawing` method.\n * @return {boolean} `true` if the interaction is dirty, `false` otherwise.\n * @observable\n */\nexports.prototype.getDirty = function() {\n  return /** @type {boolean} */ (\n    this.get('dirty'));\n};\n\n\n/**\n * Return whether the interaction is currently drawing.\n * @return {boolean} `true` if the interaction is drawing, `false` otherwise.\n * @observable\n */\nexports.prototype.getDrawing = function() {\n  return /** @type {boolean} */ (\n    this.get('drawing'));\n};\n\n\n/**\n * Return whether the interaction as a valid sketch feature, i.e. its geometry\n * is valid.\n * @return {boolean} `true` if the interaction has a valid sketch feature,\n *     `false` otherwise.\n * @observable\n */\nexports.prototype.getValid = function() {\n  return /** @type {boolean} */ (\n    this.get('valid'));\n};\n\n\n/**\n * Returns the current sketch feature.\n * @return {?ol.Feature} The sketch feature, or null if none.\n */\nexports.prototype.getFeature = function() {\n  return this.sketchFeature_;\n};\n\n\n// === PUBLIC METHODS ===\n\n\n/**\n * Add current sketch point to sketch feature if the latter exists, else create\n * it.\n */\nexports.prototype.addToDrawing = function() {\n\n  // no need to do anything if interaction is not active, nor drawing\n  const active = this.getActive();\n  const drawing = this.getDrawing();\n\n  if (!active || !drawing) {\n    return;\n  }\n\n  let sketchFeatureGeom;\n  const sketchPointGeom = this.getSketchPointGeometry_();\n  const coordinate = sketchPointGeom.getCoordinates();\n  let coordinates;\n\n  // == point ==\n  if (this.type_ === 'Point') {\n    if (!this.sketchFeature_) {\n      this.sketchFeature_ = new olFeature(new olGeomPoint(coordinate));\n      /** @type {ngeox.DrawEvent} */\n      const event = new ngeoCustomEvent('drawstart', {feature: this.sketchFeature_});\n      this.dispatchEvent(event);\n    }\n    sketchFeatureGeom = this.sketchFeature_.getGeometry();\n    googAsserts.assertInstanceof(sketchFeatureGeom, olGeomSimpleGeometry);\n    sketchFeatureGeom.setCoordinates(coordinate);\n    return;\n  }\n\n  // == line string ==\n  if (this.type_ === 'LineString') {\n    this.sketchPoints_.push(this.sketchPoint_);\n    if (!this.sketchFeature_) {\n      coordinates = [coordinate.slice(), coordinate.slice()];\n      this.sketchFeature_ = new olFeature(new olGeomLineString(coordinates));\n      /** @type {ngeox.DrawEvent} */\n      const event = new ngeoCustomEvent('drawstart', {feature: this.sketchFeature_});\n      this.dispatchEvent(event);\n    } else {\n      sketchFeatureGeom = this.sketchFeature_.getGeometry();\n      googAsserts.assertInstanceof(sketchFeatureGeom, olGeomSimpleGeometry);\n      coordinates = sketchFeatureGeom.getCoordinates();\n      coordinates.push(coordinate.slice());\n      sketchFeatureGeom.setCoordinates(coordinates);\n    }\n  }\n\n  const dirty = this.getDirty();\n  if (dirty) {\n    this.set('dirty', false);\n  }\n\n  // minPoints validation\n  const valid = this.getValid();\n  if (this.type_ === 'LineString') {\n    if (coordinates.length >= this.minPoints_) {\n      if (!valid) {\n        this.set('valid', true);\n      }\n    } else {\n      if (valid) {\n        this.set('valid', false);\n      }\n    }\n  }\n\n  // reset sketch point\n  this.sketchPoint_ = null;\n\n  // update sketch features\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Clear the drawing\n */\nexports.prototype.clearDrawing = function() {\n  this.setActive(false);\n  this.setActive(true);\n};\n\n\n/**\n * Finish drawing. If there's a sketch point, it's added first.\n */\nexports.prototype.finishDrawing = function() {\n\n  // no need to do anything if interaction is not active, nor drawing\n  const active = this.getActive();\n  const drawing = this.getDrawing();\n\n  if (!active || !drawing) {\n    return;\n  }\n\n  if (this.sketchPoint_) {\n    this.addToDrawing();\n  }\n\n  this.set('drawing', false);\n\n  /** @type {ngeox.DrawEvent} */\n  const event = new ngeoCustomEvent('drawend', {feature: this.sketchFeature_});\n  this.dispatchEvent(event);\n};\n\n\n// === PRIVATE METHODS ===\n\n\n/**\n * Start drawing by adding the sketch point first.\n * @private\n */\nexports.prototype.startDrawing_ = function() {\n  this.set('drawing', true);\n  this.createOrUpdateSketchPoint_();\n  this.updateSketchFeatures_();\n\n  if (this.type_ === 'Point') {\n    this.addToDrawing();\n  }\n};\n\n\n/**\n * Modify the geometry of the sketch feature to have its last coordinate\n * set to the center of the map.\n * @private\n */\nexports.prototype.modifyDrawing_ = function() {\n  if (!this.sketchFeature_) {\n    return;\n  }\n\n  const center = this.getCenter_();\n\n  if (this.type_ === 'LineString') {\n    const sketchFeatureGeom = this.sketchFeature_.getGeometry();\n    googAsserts.assertInstanceof(sketchFeatureGeom, olGeomSimpleGeometry);\n    const coordinates = sketchFeatureGeom.getCoordinates();\n    coordinates.pop();\n    coordinates.push(center);\n    sketchFeatureGeom.setCoordinates(coordinates);\n  }\n\n  const dirty = this.getDirty();\n  if (!dirty) {\n    this.set('dirty', true);\n  }\n\n};\n\n\n/**\n * Stop drawing without adding the sketch feature to the target layer.\n * @return {?ol.Feature} The sketch feature (or null if none).\n * @private\n */\nexports.prototype.abortDrawing_ = function() {\n  const sketchFeature = this.sketchFeature_;\n  if (sketchFeature || this.sketchPoints_.length > 0) {\n    this.sketchFeature_ = null;\n    this.sketchPoint_ = null;\n    this.overlay_.getSource().clear(true);\n  }\n  this.sketchPoints_ = [];\n  this.set('dirty', false);\n  this.set('drawing', false);\n  this.set('valid', false);\n  return sketchFeature;\n};\n\n\n/**\n * @private\n */\nexports.prototype.updateState_ = function() {\n  const map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    this.abortDrawing_();\n  } else {\n    this.startDrawing_();\n  }\n  this.overlay_.setMap(active ? map : null);\n};\n\n\n/**\n * @param {ol.Object.Event} evt Event.\n * @private\n */\nexports.prototype.handleViewCenterChange_ = function(evt) {\n  // no need to do anything if interaction is not active, nor drawing\n  const active = this.getActive();\n  const drawing = this.getDrawing();\n\n  if (!active || !drawing) {\n    return;\n  }\n\n  this.createOrUpdateSketchPoint_();\n\n  if (this.type_ === 'Point') {\n    this.addToDrawing();\n  } else {\n    this.modifyDrawing_();\n    this.updateSketchFeatures_();\n  }\n};\n\n\n/**\n * @private\n */\nexports.prototype.createOrUpdateSketchPoint_ = function() {\n  const center = this.getCenter_();\n\n  if (this.sketchPoint_) {\n    const geometry = this.getSketchPointGeometry_();\n    geometry.setCoordinates(center);\n  } else {\n    this.sketchPoint_ = new olFeature(new olGeomPoint(center));\n  }\n\n};\n\n\n/**\n * Redraw the sketch features.\n * @private\n */\nexports.prototype.updateSketchFeatures_ = function() {\n  const sketchFeatures = [];\n  if (this.sketchFeature_) {\n    sketchFeatures.push(this.sketchFeature_);\n  }\n  if (this.sketchPoint_) {\n    sketchFeatures.push(this.sketchPoint_);\n  }\n  const overlaySource = this.overlay_.getSource();\n  overlaySource.clear(true);\n  overlaySource.addFeatures(sketchFeatures);\n  overlaySource.addFeatures(this.sketchPoints_);\n};\n\n\n/**\n * Returns the geometry of the sketch point feature.\n * @return {ol.geom.Point} Point.\n * @private\n */\nexports.prototype.getSketchPointGeometry_ = function() {\n  googAsserts.assert(this.sketchPoint_, 'sketch point should be thruty');\n  const geometry = this.sketchPoint_.getGeometry();\n  googAsserts.assertInstanceof(geometry, olGeomPoint);\n  return geometry;\n};\n\n\n/**\n * Returns the center of the map view\n * @return {ol.Coordinate} Coordinate.\n * @private\n */\nexports.prototype.getCenter_ = function() {\n  const center = this.getMap().getView().getCenter();\n  googAsserts.assertArray(center);\n  return center;\n};\n\n\nexport default exports;\n"],"sourceRoot":""}