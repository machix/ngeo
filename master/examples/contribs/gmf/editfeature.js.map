{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./contribs/gmf/examples/editfeature.js"],"names":["exports","module","angular","gmfAuthenticationModule","name","gmfEditingEditFeature","gmfMapComponent","value","appURL","GMF_DEMO","GMF_LAYERS","constant","MainController","$scope","gmfEditFeature","gmfUser","scope_","editFeature_","wmsSource_","olSourceImageWMS","url","MAPSERVER_PROXY","params","wmsLayer_","olLayerImage","source","pixelBuffer_","layerId_","feature","pending","map","olMap","layers","olLayerTile","olSourceOSM","view","olView","projection","EPSG21781","resolutions","center","zoom","on","handleMapSingleClick_","bind","$","tooltip","container","trigger","prototype","evt","coordinate","getView","resolution","getResolution","buffer","extent","olExtent","getFeaturesInExtent","then","handleGetFeatures_","$apply","features","length","insertFeature","size","getSize","calculateExtent","bottomLeft","topRight","left","bottom","right","top","deltaX","deltaY","Math","random","olFeature","olGeomMultiPoint","insertFeatures","handleEditFeature_","updateFeature","console","assert","set","deleteFeature","resp","refreshWMSLayer_","updateParams","controller"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACnJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAMA,OAAO,GAAG,EAAhB;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIAA,OAAO,CAACC,MAAR,GAAiBC,OAAO,CAACD,MAAR,CAAe,QAAf,EAAyB,CACxC,SADwC,EAExCE,oEAAuB,CAACC,IAFgB,EAGxCC,kEAAqB,CAACJ,MAAtB,CAA6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","file":"editfeature.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"editfeature\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([7,\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * @module gmfapp.editfeature\n */\nconst exports = {};\n\nimport appURL from './url.js';\nimport './editfeature.css';\nimport 'jquery-ui/ui/widgets/tooltip.js';\nimport EPSG21781 from '@geoblocks/proj/src/EPSG_21781.js';\n\nimport gmfAuthenticationModule from 'gmf/authentication/module.js';\nimport gmfEditingEditFeature from 'gmf/editing/EditFeature.js';\n\n/** @suppress {extraRequire} */\nimport gmfMapComponent from 'gmf/map/component.js';\n\nimport olFeature from 'ol/Feature.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport * as olExtent from 'ol/extent.js';\nimport olGeomMultiPoint from 'ol/geom/MultiPoint.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olLayerImage from 'ol/layer/Image.js';\nimport olSourceOSM from 'ol/source/OSM.js';\nimport olSourceImageWMS from 'ol/source/ImageWMS.js';\n\n\n/** @type {!angular.IModule} **/\nexports.module = angular.module('gmfapp', [\n  'gettext',\n  gmfAuthenticationModule.name,\n  gmfEditingEditFeature.module.name,\n  gmfMapComponent.name,\n]);\n\n\nexports.module.value('authenticationBaseUrl', appURL.GMF_DEMO);\nexports.module.value('gmfLayersUrl', appURL.GMF_LAYERS);\n\nexports.module.constant('defaultTheme', 'Demo');\nexports.module.constant('angularLocaleScript', '../build/angular-locale_{{locale}}.js');\n\n\n/**\n * @param {!angular.IScope} $scope Angular scope.\n * @param {gmf.editing.EditFeature} gmfEditFeature Gmf edit feature service.\n * @param {gmfx.User} gmfUser User.\n * @constructor\n * @ngInject\n */\nexports.MainController = function($scope, gmfEditFeature, gmfUser) {\n\n  /**\n   * @type {!angular.IScope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {gmf.editing.EditFeature}\n   * @export\n   */\n  this.editFeature_ = gmfEditFeature;\n\n  /**\n   * @type {gmfx.User}\n   * @export\n   */\n  this.gmfUser = gmfUser;\n\n  /**\n   * @type {ol.source.ImageWMS}\n   * @private\n   */\n  this.wmsSource_ = new olSourceImageWMS({\n    url: appURL.MAPSERVER_PROXY,\n    params: {'LAYERS': 'point'}\n  });\n\n  /**\n   * @type {ol.layer.Image}\n   * @private\n   */\n  this.wmsLayer_ = new olLayerImage({\n    source: this.wmsSource_\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelBuffer_ = 10;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.layerId_ = 113;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.feature = null;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.pending = false;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      }),\n      this.wmsLayer_\n    ],\n    view: new olView({\n      projection: EPSG21781,\n      resolutions: [200, 100, 50, 20, 10, 5, 2.5, 2, 1, 0.5],\n      center: [537635, 152640],\n      zoom: 2\n    })\n  });\n\n  this.map.on('singleclick', this.handleMapSingleClick_.bind(this));\n\n  // initialize tooltips\n  $('[data-toggle=\"tooltip\"]').tooltip({\n    container: 'body',\n    trigger: 'hover'\n  });\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt MapBrowser event\n * @private\n */\nexports.MainController.prototype.handleMapSingleClick_ = function(evt) {\n\n  // (1) Launch query to fetch new features\n  const coordinate = evt.coordinate;\n  const map = this.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const buffer = resolution * this.pixelBuffer_;\n  const extent = olExtent.buffer(\n    [coordinate[0], coordinate[1], coordinate[0], coordinate[1]],\n    buffer\n  );\n\n  this.editFeature_.getFeaturesInExtent([this.layerId_], extent).then(\n    this.handleGetFeatures_.bind(this));\n\n  // (2) Clear any previously selected feature\n  this.feature = null;\n\n  // (3) Pending\n  this.pending = true;\n\n  this.scope_.$apply();\n};\n\n\n/**\n * @param {Array.<ol.Feature>} features Features.\n * @private\n */\nexports.MainController.prototype.handleGetFeatures_ = function(features) {\n  this.pending = false;\n\n  if (features.length) {\n    this.feature = features[0];\n  }\n};\n\n\n/**\n * Insert a new feature at a random location.\n * @export\n */\nexports.MainController.prototype.insertFeature = function() {\n\n  this.pending = true;\n\n  // (1) Create a randomly located feature\n  const map = this.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const buffer = resolution * -50; // 50 pixel buffer inside the extent\n  const size = /** @type {!Array.<number>} */ (map.getSize());\n  const extent = olExtent.buffer(\n    view.calculateExtent(size),\n    buffer\n  );\n  const bottomLeft = olExtent.getBottomLeft(extent);\n  const topRight = olExtent.getTopRight(extent);\n  const left = bottomLeft[0];\n  const bottom = bottomLeft[1];\n  const right = topRight[0];\n  const top = topRight[1];\n  const deltaX = right - left;\n  const deltaY = top - bottom;\n  const coordinate = [\n    left + Math.random() * deltaX,\n    bottom + Math.random() * deltaY\n  ];\n\n  const feature = new olFeature({\n    'geometry': new olGeomMultiPoint([coordinate]),\n    'name': 'New point'\n  });\n\n  this.feature = null; // clear selected feature\n\n  // (2) Launch request\n  this.editFeature_.insertFeatures(\n    this.layerId_,\n    [feature]\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n};\n\n\n/**\n * Update the currently selected feature with a new name.\n * @export\n */\nexports.MainController.prototype.updateFeature = function() {\n\n  console.assert(this.feature);\n\n  this.pending = true;\n\n  // (1) Update name\n  this.feature.set('name', 'Updated name');\n\n  // (2) Launch request\n  this.editFeature_.updateFeature(\n    this.layerId_,\n    this.feature\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n};\n\n\n/**\n * Delete currently selected feature.\n * @export\n */\nexports.MainController.prototype.deleteFeature = function() {\n\n  console.assert(this.feature);\n\n  // (1) Launch request\n  this.editFeature_.deleteFeature(\n    this.layerId_,\n    this.feature\n  ).then(\n    this.handleEditFeature_.bind(this)\n  );\n\n  // (2) Reset selected feature\n  this.feature = null;\n};\n\n\n/**\n * Called after an insert, update or delete request.\n * @param {angular.IHttpResponse} resp Ajax response.\n * @private\n */\nexports.MainController.prototype.handleEditFeature_ = function(resp) {\n  this.pending = false;\n  this.refreshWMSLayer_();\n};\n\n\n/**\n * @private\n */\nexports.MainController.prototype.refreshWMSLayer_ = function() {\n  this.wmsSource_.updateParams({\n    'random': Math.random()\n  });\n};\n\n\nexports.module.controller('MainController', exports.MainController);\n\n\nexport default exports;\n"],"sourceRoot":""}