{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./examples/routing.js","webpack:///./src/routing/NominatimInputComponent.js","webpack:///./src/routing/NominatimService.js","webpack:///./src/routing/RoutingComponent.js","webpack:///./src/routing/RoutingFeatureComponent.js","webpack:///./src/routing/RoutingService.js","webpack:///./src/routing/module.js","webpack:///./src/routing/nominatiminput.html","webpack:///./src/routing/routing.html","webpack:///./src/routing/routingfeature.html"],"names":["exports","module","angular","ngeoMapModule","name","ngeoRoutingModule","MainController","map","olMap","layers","olLayerTile","source","olSourceOSM","view","olView","center","zoom","routingfeatureActive","controller","ngeoSearchSearchDirective","ngeoRoutingNominatimService","run","$templateCache","put","require","value","$attrs","templateUrl","undefined","ngeoRoutingNominatimInputComponentTemplateUrl","Controller","$element","$injector","$scope","ngeoNominatimService","element_","$scope_","onSelect","inputValue","options","datasets","display","typeaheadSourceDebounced","listeners","select","select_","bind","placeholder","prototype","event","suggestion","dataset","component","bindings","$http","ngeoDebounce","$http_","ngeoDebounce_","nominatimUrl_","has","get","substr","searchDefaultParams_","typeaheadDebounceDelay_","typeaheadSource_","search","query","params","url","Object","assign","keys","option","push","join","reverse","coordinate","syncResults","asyncResults","onSuccess_","resp","parse","result","lon","lat","display_name","data","onError_","then","ngeoMiscDebounce","service","ngeoMiscFilters","ngeoRoutingRoutingService","ngeoRoutingRoutingFeatureComponent","ngeoRoutingTemplateUrl","ngeoRoutingService","$q","ngeoRoutingService_","ngeoNominatimService_","routingOptions_","routingProfiles","profiles","selectedRoutingProfile","length","$watch","calculateRoute","$q_","errorMessage","startFeature_","targetFeature_","viaArray","colors","routeSource_","olSourceVector","features","routeLayer_","olLayerVector","style","olStyleStyle","fill","olStyleFill","color","stroke","olStyleStroke","width","routeDistance","routeDuration","regexIsFormattedCoord","draw_","debounceDelay","handleChange","$onInit","addLayer","clearRoute","clear","getLonLatFromPoint_","point","geometry","getGeometry","coords","getCoordinates","projection","getView","getProjection","olProj","reverseRoute","tmpFeature","parseRoute_","route","parsedRoutes","format","olFormatGeoJSON","formatConfig","dataProjection","featureProjection","legs","leg","steps","step","olFeature","readGeometry","concat","coordFrom","coordTo","vias","filter","via","feature","routes","console","log","addFeatures","fit","getExtent","parseInt","distance","duration","startRoute","getCoordinateAt","endRoute","startToRoute","routeToEnd","routeConnections","olGeomLineString","config","when","getRoute","addVia","deleteVia","index","splice","ngeoRoutingNominatimInputComponent","ngeoRoutingFeatureTemplateUrl","$timeout","scope_","timeout_","featureLabel","fillColor","strokeColor","onChange","vectorFeatures_","olCollection","vectorSource_","vectorLayer_","resolution","text","olStyleText","font","offsetY","modifyFeature_","olInteractionModify","onSelect_","setActive","addInteraction","on","getArray","snapFeature_","newVal","oldVal","onFeatureChange_","$onDestroy","removeLayer","removeInteraction","set","olInteractionDraw","type","removeFeature","setFeature_","label","transformedCoordinate","olGeomPoint","addFeature","selected","parseFloat","newCoordinates","setCenter","coord","onSuccess","onError","component_","ngeoOsrmBackendUrl_","backendUrl","protocolVersion_","coordinates","coordinateString","c","getNearest","ngeoRoutingRoutingComponent"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACnJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAMA,OAAO,GAAG,EAAhB;AAKA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAGAA,OAAO,CAACC,MAAR,GAAiBC,OAAO,CAACD,MAAR,CAAe,KAAf,EAAsB,CACrC,SADqC,EAErCE,0DAAa,CAACC,IAFuB,EAGrCC,8DAAiB,CAACD,IAHmB,CAAtB,CAAjB;;AAYAJ,OAAO,CAACM,cAAR,GAAyB,YAAW;AAMlC,OAA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","file":"routing.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"routing\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([36,\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * @module app.routing\n */\nconst exports = {};\n\n/**\n * This example shows the ngeo routing directive.\n */\nimport './routing.css';\nimport 'ol/ol.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport '@fortawesome/fontawesome-free/css/fontawesome.min.css';\n\nimport ngeoMapModule from 'ngeo/map/module.js';\nimport ngeoRoutingModule from 'ngeo/routing/module.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olSourceOSM from 'ol/source/OSM.js';\n\n/** @type {!angular.IModule} **/\nexports.module = angular.module('app', [\n  'gettext',\n  ngeoMapModule.name,\n  ngeoRoutingModule.name\n]);\n\n\n/**\n * The application's main directive.\n * @constructor\n * @ngInject\n */\nexports.MainController = function() {\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      })\n    ],\n    view: new olView({\n      center: [931010.1535989442, 5961705.842297254],\n      zoom: 9\n    })\n  });\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.routingfeatureActive = true;\n};\n\nexports.module.controller('MainController', exports.MainController);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.NominatimInputComponent\n */\nconst exports = {};\nimport ngeoSearchSearchDirective from 'ngeo/search/searchDirective.js';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\n\n\n/**\n * @type {!angular.IModule}\n */\nexports.module = angular.module('ngeoRoutingNominatimInputComponent', [\n  ngeoSearchSearchDirective.module.name,\n  ngeoRoutingNominatimService.module.name\n]);\n\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('ngeo/routing/nominatiminput', require('./nominatiminput.html'));\n});\n\n\nexports.module.value('ngeoRoutingNominatimInputComponentTemplateUrl',\n  /**\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingNominatimInputComponentTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/nominatiminput';\n  }\n);\n\n\n/**\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.Attributes): string} ngeoRoutingNominatimInputComponentTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction ngeoRoutingNominatimInputComponentTemplateUrl($attrs, ngeoRoutingNominatimInputComponentTemplateUrl) {\n  return ngeoRoutingNominatimInputComponentTemplateUrl($attrs);\n}\n\n\n/**\n * @param {!angular.JQLite} $element Element.\n * @param {angular.IInjectorService} $injector Main injector.\n * @param {!angular.IScope} $scope Scope.\n * @param {!ngeo.routing.NominatimService} ngeoNominatimService service for Nominatim\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoNominatimInputController\n */\nexports.Controller = function($element, $injector, $scope, ngeoNominatimService) {\n\n  /**\n   * @type {!angular.JQLite}\n   * @private\n   */\n  this.element_ = $element;\n\n  /**\n   * @type {angular.IScope}\n   * @private\n   */\n  this.$scope_ = $scope;\n\n  /**\n   * @type {ngeo.routing.NominatimService}\n   * @export\n   */\n  this.ngeoNominatimService = ngeoNominatimService;\n\n  /**\n   * @type {(function(Object)|undefined)}\n   * @export\n   */\n  this.onSelect;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.inputValue;\n\n  /**\n   * @type {TypeaheadOptions}\n   * @export\n   */\n  this.options = /** @type {TypeaheadOptions} */ ({\n  });\n\n  /**\n   * @type {Array.<TypeaheadDataset>}\n   * @export\n   */\n  this.datasets = [/** @type {TypeaheadDataset} */({\n    name: 'nominatim',\n    display: 'name',\n    source: this.ngeoNominatimService.typeaheadSourceDebounced\n  })];\n\n  /**\n   * @type {ngeox.SearchDirectiveListeners}\n   * @export\n   */\n  this.listeners = /** @type {ngeox.SearchDirectiveListeners} */({\n    select: this.select_.bind(this)\n  });\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.placeholder = '';\n\n};\n\n/**\n * @param {jQuery.Event} event Event.\n * @param {ngeox.NominatimSearchResult} suggestion Suggestion.\n * @param {TypeaheadDataset} dataset Dataset.\n * @this {ngeo.routing.NominatimInputComponent.Controller}\n * @private\n */\nexports.Controller.prototype.select_ = function(event, suggestion, dataset) {\n  if (this.onSelect) {\n    this.onSelect(suggestion);\n  }\n};\n\n/**\n * Input form field which provides Nominatim typeahead lookup using {@link ngeo.routing.NominatimService}.\n *\n * Example:\n *\n *     <ngeo-nominatim-input\n *         ngeo-nominatim-input-value=\"ctrl.label\"\n *         ngeo-nominatim-input-placeholder=\"type to search\"\n *         ngeo-nominatim-input-on-select=\"ctrl.onSelect\">\n *\n * Is used in in the partial of {@link ngeo.routingFeatureComponent}.\n *\n * See the [../examples/routing.html](../examples/routing.html) example to see it in action.\n *\n * @htmlAttribute {function(ngeox.NominatimSearchResult)} ngeo-nominatim-input-on-select\n *  Event fired when user selects a new suggestion.\n * @htmlAttribute {string} ngeo-nominatim-input-value\n *  Value of input field, will be set to the label of the search result.\n * @htmlAttribute {string} ngeo-nominatim-input-placeholder\n *  Placeholder text, when field is empty.\n * @ngdoc directive\n * @ngname ngeoNominatimInput\n */\nconst component = {\n  controller: exports.Controller,\n  bindings: {\n    'onSelect': '=?ngeoNominatimInputOnSelect',\n    'inputValue': '=?ngeoNominatimInputValue',\n    'placeholder': '@?ngeoNominatimInputPlaceholder'\n  },\n  templateUrl: ngeoRoutingNominatimInputComponentTemplateUrl\n};\n\nexports.module.component('ngeoNominatimInput', component);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.NominatimService\n */\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\n\n/**\n * Service to provide access to Nominatim, which allows to search for\n * OSM data by name and address.\n * @param {angular.IHttpService} $http Angular http service.\n * @param {angular.IInjectorService} $injector Main injector.\n * @param {ngeox.miscDebounce} ngeoDebounce ngeo Debounce service.\n * @constructor\n * @struct\n * @ngdoc service\n * @ngInject\n * @export\n * @ngname ngeoNominatimService\n * @see https://wiki.openstreetmap.org/wiki/Nominatim\n */\nconst exports = function($http, $injector, ngeoDebounce) {\n\n  /**\n   * @type {angular.IHttpService}\n   * @private\n   */\n  this.$http_ = $http;\n\n  /**\n   * @type {ngeox.miscDebounce}\n   * @private\n   */\n  this.ngeoDebounce_ = ngeoDebounce;\n\n  /**\n   * URL for Nominatim backend\n   * Defaults openstreetmap instance.\n   * @type {string}\n   * @private\n   */\n  this.nominatimUrl_ = 'https://nominatim.openstreetmap.org/';\n\n  if ($injector.has('ngeoNominatimUrl')) {\n    this.nominatimUrl_ = $injector.get('ngeoNominatimUrl');\n\n    // the url is expected to end with a slash\n    if (this.nominatimUrl_.substr(-1) !== '/') {\n      this.nominatimUrl_ += '/';\n    }\n  }\n\n  /**\n   * @type {Object<string, string>}\n   * @private\n   */\n  this.searchDefaultParams_ = {};\n\n  if ($injector.has('ngeoNominatimSearchDefaultParams')) {\n    this.searchDefaultParams_ = $injector.get('ngeoNominatimSearchDefaultParams');\n  }\n\n  /**\n   * Delay (in milliseconds) to avoid calling the API too often.\n   * Only if there were no calls for that many milliseconds,\n   * the last call will be executed.\n   * @type {number}\n   * @private\n   */\n  this.typeaheadDebounceDelay_ = 500;\n\n  /**\n   * @export\n   * @type {function(string,function(Array.<BloodhoundDatum>),(function(Array.<ol.Feature>)|undefined))}\n   */\n  this.typeaheadSourceDebounced =\n    /** @type{function(string,function(Array.<BloodhoundDatum>),(function(Array.<ol.Feature>)|undefined))} */\n    (this.ngeoDebounce_(/** @type {function(?)} */ (this.typeaheadSource_.bind(this)), this.typeaheadDebounceDelay_, true));\n};\n\n/**\n * Search by name\n * @param {string} query Search query\n * @param {?Object} params Optional parameters\n * @return {!angular.IHttpPromise} promise of the Nominatim API request\n * @see https://wiki.openstreetmap.org/wiki/Nominatim#Search\n * @export\n */\nexports.prototype.search = function(query, params) {\n  let url = `${this.nominatimUrl_}search?q=${query}`;\n\n  params = params || {};\n  params = Object.assign({}, this.searchDefaultParams_, params);\n\n  // require JSON response\n  params['format'] = 'json';\n\n  if (params) {\n    url += '&';\n    const options = [];\n    for (const option of Object.keys(params)) {\n      options.push(`${option}=${params[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * Reverse Geocoding\n * @param {ol.Coordinate} coordinate Search coordinate in LonLat projection\n * @param {(Object|undefined)} params Optional parameters\n * @return {!angular.IHttpPromise} promise of the Nominatim API request\n * @see https://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding\n * @export\n */\nexports.prototype.reverse = function(coordinate, params) {\n  let url = `${this.nominatimUrl_}reverse`;\n\n  params = Object.assign({}, params);\n\n  // coordinate\n  params['lon'] = coordinate[0];\n  params['lat'] = coordinate[1];\n\n  // require JSON response\n  params['format'] = 'json';\n\n  if (params) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(params)) {\n      options.push(`${option}=${params[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * @param {string} query Search query\n * @param {function(Array.<BloodhoundDatum>)} syncResults Callback for synchronous execution, unused\n * @param {function(Array.<ngeox.NominatimSearchResult>)} asyncResults Callback for asynchronous execution\n * @private\n */\nexports.prototype.typeaheadSource_ = function(query, syncResults, asyncResults) {\n  const onSuccess_ = function(resp) {\n    /**\n     * Parses result response.\n     * @param {ngeox.NominatimSearchResponseResult} result Result\n     * @return {ngeox.NominatimSearchResult} Parsed result\n     */\n    const parse = function(result) {\n      return /** @type{ngeox.NominatimSearchResult} */({\n        coordinate: [result.lon, result.lat],\n        name: result.display_name\n      });\n    };\n    asyncResults(resp.data.map(parse));\n  };\n\n  const onError_ = function(resp) {\n    asyncResults([]);\n  };\n\n  this.search(query, {}).then(onSuccess_, onError_);\n};\n\n/**\n * @type {!angular.IModule}\n */\nexports.module = angular.module('ngeoNominatimService', [\n  ngeoMiscDebounce.name\n]);\n\nexports.module.service('ngeoNominatimService', exports);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.RoutingComponent\n */\nconst exports = {};\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\nimport ngeoMiscFilters from 'ngeo/misc/filters.js';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\nimport ngeoRoutingRoutingService from 'ngeo/routing/RoutingService.js';\nimport ngeoRoutingRoutingFeatureComponent from 'ngeo/routing/RoutingFeatureComponent.js';\nimport olFormatGeoJSON from 'ol/format/GeoJSON.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olStyleStyle from 'ol/style/Style.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport * as olProj from 'ol/proj.js';\nimport olFeature from 'ol/Feature.js';\nimport olGeomLineString from 'ol/geom/LineString.js';\nimport 'ngeo/sass/font.scss';\n\nexports.module = angular.module('ngeoRoutingComponent', [\n  ngeoMiscDebounce.name,\n  ngeoMiscFilters.name,\n  ngeoRoutingNominatimService.module.name,\n  ngeoRoutingRoutingService.module.name,\n  ngeoRoutingRoutingFeatureComponent.module.name\n]);\n\n\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('ngeo/routing/routing', require('./routing.html'));\n});\n\n\nexports.module.value('ngeoRoutingTemplateUrl',\n  /**\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/routing';\n  }\n);\n\n\n/**\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.Attributes): string} ngeoRoutingTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction ngeoRoutingTemplateUrl($attrs, ngeoRoutingTemplateUrl) {\n  return ngeoRoutingTemplateUrl($attrs);\n}\n\n\n/**\n * The controller for the routing directive.\n * @param {angular.IInjectorService} $injector Main injector.\n * @param {!angular.IScope} $scope Scope.\n * @param {!ngeo.routing.RoutingService} ngeoRoutingService service for OSRM routing\n * @param {!ngeo.routing.NominatimService} ngeoNominatimService service for Nominatim\n * @param {!angular.IQService} $q Angular q service\n * @param {ngeox.miscDebounce} ngeoDebounce ngeo Debounce service.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoRoutingController\n */\nexports.Controller = function($injector, $scope, ngeoRoutingService, ngeoNominatimService, $q, ngeoDebounce) {\n\n  /**\n   * @type {angular.IScope}\n   * @private\n   */\n  this.$scope_ = $scope;\n\n  /**\n   * @type {ngeo.routing.RoutingService}\n   * @private\n   */\n  this.ngeoRoutingService_ = ngeoRoutingService;\n\n  /**\n   * @type {ngeo.routing.NominatimService}\n   * @private\n   */\n  this.ngeoNominatimService_ = ngeoNominatimService;\n\n  /**\n   * @type {ngeox.RoutingOptions}\n   * @private\n   */\n  this.routingOptions_ = $injector.has('ngeoRoutingOptions') ? $injector.get('ngeoRoutingOptions') : {};\n\n  /**\n   * Available routing profiles.\n   * Example: [\n   *            {\n   *              label: 'Car', // used as label in the UI\n   *              profile: 'routed-car' // used as part of the query\n   *            }\n   *          ]\n   * @type {Array<ngeox.RoutingProfile>}\n   * @export\n   */\n  this.routingProfiles = this.routingOptions_.profiles || [];\n\n  /**\n   * @type {?ngeox.RoutingProfile}\n   * @export\n   */\n  this.selectedRoutingProfile = this.routingProfiles.length > 0 ? this.routingProfiles[0] : null;\n\n  $scope.$watch(\n    () => this.selectedRoutingProfile,\n    this.calculateRoute.bind(this)\n  );\n\n  /**\n   * @type {angular.IQService}\n   * @private\n   */\n  this.$q_ = $q;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.errorMessage = '';\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.startFeature_ = null;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.targetFeature_ = null;\n\n  /**\n   * @type {Array.<ngeox.RoutingVia>}\n   * @export\n   */\n  this.viaArray = [];\n\n  /**\n   * @type {Object<string, string>}\n   * @export\n   */\n  this.colors = {\n    'start.fill': '#6BE62E',\n    'start.stroke': '#4CB01E',\n    'destination.fill': '#FF3E13',\n    'destination.stroke': '#CD3412',\n    'via.fill': '#767676',\n    'via.stroke': '#000000'\n  };\n\n  /**\n   * @type {ol.source.Vector}\n   * @private\n   */\n  this.routeSource_ = new olSourceVector({\n    features: []\n  });\n\n  /**\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.routeLayer_ = new olLayerVector({\n    source: this.routeSource_,\n    style: new olStyleStyle({\n      fill: new olStyleFill({\n        color: 'rgba(16, 112, 29, 0.6)'\n      }),\n      stroke: new olStyleStroke({\n        color: 'rgba(16, 112, 29, 0.6)',\n        width: 5\n      })\n    })\n  });\n\n  /**\n   * Distance of route in meters\n   * @type {number}\n   * @export\n   */\n  this.routeDistance = 0;\n\n  /**\n   * Duration of route in minutes.\n   * @type {?number}\n   * @export\n   */\n  this.routeDuration = null;\n\n  /**\n   * @type {RegExp}\n   * @private\n   */\n  this.regexIsFormattedCoord = /\\d+\\.\\d+\\/\\d+\\.\\d+/;\n\n  /**\n   * @type {ol.interaction.Draw}\n   * @private\n   */\n  this.draw_ = null;\n\n  const debounceDelay = 200; // in milliseconds\n\n  /**\n   * Debounced because in some cases (reverse route) multiple changes are done\n   * at once and spam this function.\n   * @export\n   * @type {function()}\n   */\n  this.handleChange = /** @type {function()} */\n          (ngeoDebounce(\n            /** @type {function(?)} */ (this.calculateRoute.bind(this)),\n            debounceDelay,\n            true));\n};\n\n/**\n * Init the controller\n */\nexports.Controller.prototype.$onInit = function() {\n  this.map.addLayer(this.routeLayer_);\n};\n\n/**\n * Clears start, end and vias. Removes features from map.\n * @export\n */\nexports.Controller.prototype.clearRoute = function() {\n  this.startFeature_ = null;\n  this.targetFeature_ = null;\n  this.viaArray = [];\n  this.routeDistance = 0;\n  this.routeDuration = null;\n  this.routeSource_.clear();\n  this.errorMessage = '';\n};\n\n/**\n * Converts feature point into LonLat coordinate.\n * @param {ol.Feature} point Feature point to convert\n * @return {ol.Coordinate} LonLat coordinate\n * @private\n */\nexports.Controller.prototype.getLonLatFromPoint_ = function(point) {\n  const geometry = /** @type {ol.geom.Point} */ (point.getGeometry());\n  const coords = geometry.getCoordinates();\n  const projection = this.map.getView().getProjection();\n  return olProj.toLonLat(coords, projection);\n};\n\n/**\n * Flip start and target and re-calculate route.\n * @export\n */\nexports.Controller.prototype.reverseRoute = function() {\n  // swap start and target\n  const tmpFeature = this.startFeature_;\n  this.startFeature_ = this.targetFeature_;\n  this.targetFeature_ = tmpFeature;\n\n  // reverse vias\n  this.viaArray = this.viaArray.reverse();\n\n  // recalculation is done by the debounced handleChange\n};\n\n/**\n * @param {Object} route Routes of OSRM response\n * @returns {Array<ol.Feature>} parsed route features\n * @private\n */\nexports.Controller.prototype.parseRoute_ = function(route) {\n  let parsedRoutes = [];\n  const format = new olFormatGeoJSON();\n  const formatConfig = {\n    dataProjection: 'EPSG:4326',\n    featureProjection: this.map.getView().getProjection()\n  };\n  // if there are is useful \"legs\" data, parse this\n  if (route.legs) {\n    parsedRoutes = route.legs.map(leg => leg.steps.map(step => new olFeature({geometry: format.readGeometry(step.geometry, formatConfig)})));\n    // flatten\n    parsedRoutes = [].concat(...parsedRoutes);\n  } else if (route.geometry) {\n  // otherwise parse (overview) geometry\n    parsedRoutes.push(new olFeature({geometry: format.readGeometry(route.geometry, formatConfig)}));\n  }\n  return parsedRoutes;\n};\n\n/**\n * @export\n */\nexports.Controller.prototype.calculateRoute = function() {\n  if (this.startFeature_ && this.targetFeature_) {\n    // remove rendered routes\n    this.routeSource_.clear();\n\n    const coordFrom = this.getLonLatFromPoint_(this.startFeature_);\n    const coordTo = this.getLonLatFromPoint_(this.targetFeature_);\n    const vias = this.viaArray.filter(via => via.feature !== null).map(via => this.getLonLatFromPoint_(via.feature));\n    const route = [coordFrom].concat(vias, [coordTo]);\n\n    const onSuccess_ = (function(resp) {\n      const features = this.parseRoute_(resp.data.routes[0]);\n      if (features.length === 0) {\n        console.log('No route or not supported format.');\n        return;\n      }\n      this.routeSource_.addFeatures(features);\n\n      // recenter map on route\n      this.map.getView().fit(this.routeSource_.getExtent());\n\n      this.routeDistance = parseInt(resp.data.routes[0].distance, 10);\n      this.routeDuration = resp.data.routes[0].duration;\n\n      // get first and last coordinate of route\n      const startRoute = /** @type{ol.geom.LineString} */(features[0].getGeometry()).getCoordinateAt(0);\n      const endRoute = /** @type{ol.geom.LineString} */(features[features.length - 1].getGeometry()).getCoordinateAt(1);\n\n      // build geometries to connect route to start and end point of query\n      const startToRoute = [/** @type {ol.geom.Point} */(this.startFeature_.getGeometry()).getCoordinates(), startRoute];\n      const routeToEnd = [endRoute, /** @type {ol.geom.Point} */(this.targetFeature_.getGeometry()).getCoordinates()];\n      const routeConnections = [\n        new olFeature(new olGeomLineString(startToRoute)),\n        new olFeature(new olGeomLineString(routeToEnd))\n      ];\n\n      // add them to the source\n      this.routeSource_.addFeatures(routeConnections);\n    }).bind(this);\n\n    const onError_ = (function(resp) {\n      this.errorMessage = 'Error: routing server not responding.';\n      console.log(resp);\n    }).bind(this);\n\n    const options = {};\n    options['steps'] = true;\n    options['overview'] = false;\n    options['geometries'] = 'geojson';\n\n    const config = {};\n    config['options'] = options;\n\n    if (this.selectedRoutingProfile) {\n      config['instance'] = this.selectedRoutingProfile['profile'];\n    }\n\n    this.$q_.when(this.ngeoRoutingService_.getRoute(route, config))\n      .then(onSuccess_.bind(this), onError_.bind(this));\n  }\n};\n\n/**\n * @export\n */\nexports.Controller.prototype.addVia = function() {\n  this.viaArray.push(/** @type{ngeox.RoutingVia} */({\n    feature: null,\n    onSelect: null\n  }));\n};\n\n/**\n * @param {number} index Array index.\n * @export\n */\nexports.Controller.prototype.deleteVia = function(index) {\n  if (this.viaArray.length > index) {\n    this.viaArray.splice(index, 1);\n    this.calculateRoute();\n  }\n};\n\n\nexports.module.component('ngeoRouting', {\n  controller: exports.Controller,\n  bindings: {\n    'map': '<ngeoRoutingMap'\n  },\n  templateUrl: ngeoRoutingTemplateUrl\n});\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.RoutingFeatureComponent\n */\nconst exports = {};\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\nimport ngeoRoutingNominatimInputComponent from 'ngeo/routing/NominatimInputComponent.js';\nimport * as olProj from 'ol/proj.js';\nimport olFeature from 'ol/Feature.js';\nimport olCollection from 'ol/Collection.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olStyleStyle from 'ol/style/Style.js';\nimport olStyleText from 'ol/style/Text.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olInteractionModify from 'ol/interaction/Modify.js';\nimport olInteractionDraw from 'ol/interaction/Draw.js';\nimport 'ngeo/sass/font.scss';\n\n\n/**\n * @type {!angular.IModule}\n */\nexports.module = angular.module('ngeoRoutingFeatureComponent', [\n  ngeoRoutingNominatimService.module.name,\n  ngeoRoutingNominatimInputComponent.module.name\n]);\n\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('ngeo/routing/routingfeature', require('./routingfeature.html'));\n});\n\n\nexports.module.value('ngeoRoutingFeatureTemplateUrl',\n  /**\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingFeatureTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/routingfeature';\n  }\n);\n\n/**\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.Attributes): string} ngeoRoutingFeatureTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction ngeoRoutingFeatureTemplateUrl($attrs, ngeoRoutingFeatureTemplateUrl) {\n  return ngeoRoutingFeatureTemplateUrl($attrs);\n}\n\n\n/**\n * @param {!angular.IScope} $scope Angular scope.\n * @param {angular.ITimeoutService} $timeout Angular timeout service.\n * @param {!angular.IQService} $q Angular q service\n * @param {!ngeo.routing.NominatimService} ngeoNominatimService service for Nominatim\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoRoutingFeatureController\n */\nexports.Controller = function($scope, $timeout, $q, ngeoNominatimService) {\n\n  /**\n   * @type {!angular.IScope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {angular.ITimeoutService}\n   * @private\n   */\n  this.timeout_ = $timeout;\n\n  /**\n   * @type {angular.IQService}\n   * @private\n   */\n  this.$q_ = $q;\n\n  /**\n   * @type {ngeo.routing.NominatimService}\n   * @private\n   */\n  this.ngeoNominatimService_ = ngeoNominatimService;\n\n  /**\n   * @type {ol.Map}\n   * @private\n   */\n  this.map;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.feature;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.featureLabel = '';\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.fillColor;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.strokeColor;\n\n  /**\n   * @type {function(ol.Feature)}\n   * @export\n   */\n  this.onChange;\n\n  /**\n   * @type {ol.Collection}\n   * @private\n   */\n  this.vectorFeatures_ = new olCollection();\n\n  /**\n   * @type {ol.source.Vector}\n   * @private\n   */\n  this.vectorSource_ = new olSourceVector({\n    features: this.vectorFeatures_\n  });\n\n  /**\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.vectorLayer_ = new olLayerVector({\n    source: this.vectorSource_,\n    style: (function(feature, resolution) {\n      return [new olStyleStyle({\n        text: new olStyleText({\n          fill: new olStyleFill({\n            color: this.fillColor || '#000000'\n          }),\n          font: 'normal 30px FontAwesome',\n          offsetY: -15,\n          stroke: new olStyleStroke({\n            width: 3,\n            color: this.strokeColor || '#000000'\n          }),\n          text: '\\uf041'\n        })\n      })];\n    }).bind(this)\n  });\n\n  /**\n   * Interaction for moving start and end.\n   * @type {ol.interaction.Modify}\n   * @private\n   */\n  this.modifyFeature_ = new olInteractionModify({\n    features: this.vectorFeatures_\n  });\n\n  /**\n   * @type {ol.interaction.Draw}\n   * @private\n   */\n  this.draw_ = null;\n\n  /**\n   * @param {ngeox.NominatimSearchResult} selected Selected result.\n   * @export\n   */\n  this.onSelect = this.onSelect_.bind(this);\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.errorMessage = '';\n};\n\nexports.Controller.prototype.$onInit = function() {\n  this.map.addLayer(this.vectorLayer_);\n\n  // setup modify interaction\n  this.modifyFeature_.setActive(true);\n  this.map.addInteraction(this.modifyFeature_);\n\n  this.modifyFeature_.on('modifyend', (event) => {\n    const feature = event.features.getArray()[0];\n    this.vectorSource_.clear();\n    this.snapFeature_(feature);\n  });\n\n  this.scope_.$watch(\n    () => this.feature,\n    (newVal, oldVal) => {\n      if (newVal) {\n        this.onFeatureChange_();\n      }\n      if (newVal === null) {\n        this.vectorSource_.clear();\n        this.featureLabel = '';\n      }\n    }\n  );\n};\n\n/**\n * Cleanup, mostly relevant for vias.\n */\nexports.Controller.prototype.$onDestroy = function() {\n  this.map.removeLayer(this.vectorLayer_);\n  this.modifyFeature_.setActive(false);\n  this.map.removeInteraction(this.modifyFeature_);\n};\n\n/**\n * @export\n */\nexports.Controller.prototype.set = function() {\n  if (this.draw_) {\n    this.map.removeInteraction(this.draw_);\n  }\n\n  this.draw_ = new olInteractionDraw({\n    features: this.vectorFeatures_,\n    type: /** @type {ol.geom.GeometryType} */ ('Point')\n  });\n\n  this.draw_.on('drawstart', () => {\n    if (this.feature) {\n      this.vectorSource_.removeFeature(this.feature);\n    }\n  });\n\n  this.draw_.on('drawend', (event) => {\n    if (this.draw_) {\n      this.map.removeInteraction(this.draw_);\n    }\n    this.snapFeature_(event.feature);\n    this.modifyFeature_.setActive(true);\n  });\n\n  this.modifyFeature_.setActive(false);\n  this.map.addInteraction(this.draw_);\n};\n\n/**\n * @param {ol.Coordinate} coordinate LonLat coordinate.\n * @param {string} label Feature name/label.\n * @private\n */\nexports.Controller.prototype.setFeature_ = function(coordinate, label) {\n  const transformedCoordinate = olProj.fromLonLat(coordinate, this.map.getView().getProjection());\n  if (label === '') {\n    label = transformedCoordinate.join('/');\n  }\n  this.feature = new olFeature({\n    geometry: new olGeomPoint(transformedCoordinate),\n    name: label\n  });\n};\n\nexports.Controller.prototype.onFeatureChange_ = function() {\n  // update label\n  this.featureLabel = /** @type{string} */(this.feature.get('name') || '');\n\n  //update vector source\n  this.vectorSource_.clear();\n  this.vectorSource_.addFeature(this.feature);\n\n  // notify others\n  if (this.onChange) {\n    this.timeout_(() => {\n      this.onChange(this.feature);\n    });\n  }\n};\n\n/**\n * @param {ngeox.NominatimSearchResult} selected Selected result.\n * @private\n */\nexports.Controller.prototype.onSelect_ = function(selected) {\n  const coordinate = selected.coordinate.map(parseFloat);\n  const label = selected.label;\n  this.setFeature_(coordinate, label);\n  const newCoordinates = /** @type{ol.geom.Point} */(this.feature.getGeometry()).getCoordinates();\n  this.map.getView().setCenter(newCoordinates);\n};\n\n/**\n * Snaps a feature to the street network using the getNearest\n * function of the routing service. Replaces the feature.\n * @param {ol.Feature} feature Feature to snap\n * @private\n */\nexports.Controller.prototype.snapFeature_ = function(feature) {\n  const coord = this.getLonLatFromPoint_(feature);\n  const config = {};\n\n  const onSuccess = (function(resp) {\n    const lon = parseFloat(resp['data']['lon']);\n    const lat = parseFloat(resp['data']['lat']);\n    const coordinate = [lon, lat];\n    const label = resp['data']['display_name'];\n    this.setFeature_(coordinate, label);\n  }).bind(this);\n\n  const onError = (function(resp) {\n    this.errorMessage = 'Error: nominatim server not responding.';\n    console.log(resp);\n  }).bind(this);\n\n  this.$q_.when(this.ngeoNominatimService_.reverse(coord, config))\n    .then(onSuccess.bind(this), onError.bind(this));\n};\n\n/**\n * Converts feature point into LonLat coordinate.\n * @param {ol.Feature} point Feature point to convert\n * @return {ol.Coordinate} LonLat coordinate\n * @private\n */\nexports.Controller.prototype.getLonLatFromPoint_ = function(point) {\n  const geometry = /** @type {ol.geom.Point} */ (point.getGeometry());\n  const coords = geometry.getCoordinates();\n  const projection = this.map.getView().getProjection();\n  return olProj.toLonLat(coords, projection);\n};\n\n\n/**\n * Provides a text input and draw interaction to allow a user to create and modify a ol.Feature (point geometry).\n *\n * The text input is provided by {@link ngeo.nominatimInputComponent} and includes Nominatim search.\n *\n * Example:\n *\n *     <ngeo-routing-feature\n *         ngeo-routing-feature-map=\"ctrl.map\"\n *         ngeo-routing-feature-feature=\"ctrl.feature\"\n *         ngeo-routing-feature-fill-color=\"#6BE62E\"\n *         ngeo-routing-feature-stroke-color=\"#4CB01E\"\n *         ngeo-routing-feature-on-change=\"ctrl.handleChange\">\n *\n * Is used in in the partial of {@link ngeo.routingComponent}.\n *\n * See the [../examples/routing.html](../examples/routing.html) example for a usage sample.\n *\n * @htmlAttribute {ol.Map} ngeo-routing-feature-map The map.\n * @htmlAttribute {ol.Feature} ngeo-routing-feature-feature The feature.\n * @htmlAttribute {string} ngeo-routing-feature-fill-color The marker fill color.\n * @htmlAttribute {string} ngeo-routing-feature-stroke-color The marker stroke color.\n * @htmlAttribute {function(ol.Feature)} ngeo-routing-feature-on-change Event fired when feature changes.\n * @ngdoc directive\n * @ngname ngeoRoutingFeature\n */\nexports.component_ = {\n  controller: exports.Controller,\n  bindings: {\n    'map': '<ngeoRoutingFeatureMap',\n    'feature': '=ngeoRoutingFeatureFeature',\n    'fillColor': '<?ngeoRoutingFeatureFillColor',\n    'strokeColor': '<?ngeoRoutingFeatureStrokeColor',\n    'onChange': '=?ngeoRoutingFeatureOnChange'\n  },\n  templateUrl: ngeoRoutingFeatureTemplateUrl\n};\n\nexports.module.component('ngeoRoutingFeature', exports.component_);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.RoutingService\n */\n/**\n * Service to provide access to a [Open Source Routing Machine (OSRM) backend](https://github.com/Project-OSRM/osrm-backend)\n * of version 5.8 and higher and its features.\n * @param {angular.IHttpService} $http Angular http service.\n * @param {angular.IInjectorService} $injector Main injector.\n * @constructor\n * @struct\n * @ngdoc service\n * @ngInject\n * @export\n * @ngname ngeoRoutingService\n */\nconst exports = function($http, $injector) {\n\n  /**\n   * @type {angular.IHttpService}\n   * @private\n   */\n  this.$http_ = $http;\n\n  /**\n   * @type {ngeox.RoutingOptions}\n   * @private\n   */\n  this.routingOptions_ = $injector.has('ngeoRoutingOptions') ? $injector.get('ngeoRoutingOptions') : {};\n\n  /**\n   * URL for OSRM backend API.\n   * Defaults to demo backend.\n   * @type {string}\n   * @private\n   */\n  this.ngeoOsrmBackendUrl_ = this.routingOptions_.backendUrl || 'https://router.project-osrm.org/';\n\n  // the url is expected to end with a slash\n  if (this.ngeoOsrmBackendUrl_.substr(-1) !== '/') {\n    this.ngeoOsrmBackendUrl_ += '/';\n  }\n\n  /**\n   * Version of the protocol implemented by the service.\n   * see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md\n   * @type {string}\n   * @private\n   */\n  this.protocolVersion_ = 'v1';\n\n};\n\n/**\n * Route request\n * @param {Array.<ol.Coordinate>} coordinates coordinates of the route (at least two!)\n * @param {?Object} config optional configuration\n * @return {!angular.IHttpPromise} promise of the OSRM API request\n */\nexports.prototype.getRoute = function(coordinates, config) {\n\n  config = config || {};\n\n  // Service\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#requests\n  if (!config['service']) {\n    config['service'] = 'route'; // default to route\n  }\n\n  // Mode of transportation,\n  // can be: car, bike, foot\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#requests\n  //\n  // As of version 5.8.0, OSRM (server) does not support multiple profiles simultaneously.\n  // This means the value actually does not matter.\n  if (!config['profile']) {\n    config['profile'] = 'car'; // default to car\n  }\n\n  // build request URL\n  let url = this.ngeoOsrmBackendUrl_;\n\n  // Common workaround to provide multiple profiles (since it is not supported yet)\n  // Every profile runs on its own instance.\n  if (config['instance']) {\n    url += `${config['instance']}/`;\n  }\n\n  url += `${config['service']}/${this.protocolVersion_}/${config['profile']}/`;\n\n  // [ [a,b] , [c,d] ] -> 'a,b;c,d'\n  const coordinateString = coordinates.map(c => c.join(',')).join(';');\n\n  url += coordinateString;\n\n  // look for route service options\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#route-service\n  if (config.options) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(config.options)) {\n      options.push(`${option}=${config.options[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * Snaps a coordinate to the street network and returns the nearest match\n * @param {ol.Coordinate} coordinate coordinate to query\n * @param {?Object} config optional configuration\n * @return {!angular.IHttpPromise} promise of the OSRM API request\n * @see https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#nearest-service\n */\nexports.prototype.getNearest = function(coordinate, config) {\n  config = config || {};\n\n  // service is always nearest\n  config['service'] = 'nearest';\n\n  // Mode of transportation\n  // If used in combination with a getRoute request, choose the same profile.\n  if (!config['profile']) {\n    config['profile'] = 'car'; // default to car\n  }\n\n  // build request URL\n  let url = this.ngeoOsrmBackendUrl_;\n\n  // Common workaround to provide multiple profiles (since it is not supported yet)\n  // Every profile runs on its own instance.\n  if (config['instance']) {\n    url += `${config['instance']}/`;\n  }\n\n  url += `${config['service']}/${this.protocolVersion_}/${config['profile']}/`;\n\n  // [a,b] -> 'a,b'\n  const coordinateString = coordinate.join(',');\n  url += coordinateString;\n\n  // look for nearest service options\n  if (config.options) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(config.options)) {\n      options.push(`${option}=${config.options[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n\n/**\n * @type {!angular.IModule}\n */\nexports.module = angular.module('ngeoRoutingService', [\n]);\n\nexports.module.service('ngeoRoutingService', exports);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.module\n */\nimport * as angular from 'angular';\nimport ngeoRoutingRoutingComponent from 'ngeo/routing/RoutingComponent.js';\n\nimport './routing.scss';\n\n/**\n * @type {angular.IModule}\n */\nexport default angular.module('ngeoRoutingModule', [\n  ngeoRoutingRoutingComponent.module.name\n]);\n","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"ngeo-nominatim-input\">\\n  <input type=\"text\"\\n         class=\"form-control\"\\n         placeholder=\"{{$ctrl.placeholder}}\"\\n         ng-model=\"$ctrl.inputValue\"\\n         ngeo-search=\"$ctrl.options\"\\n         ngeo-search-datasets=\"$ctrl.datasets\"\\n         ngeo-search-listeners=\"$ctrl.listeners\">\\n</div>\\n';\n\n}\nreturn __p\n}","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"ngeo-routing\">\\n  <div class=\"ngeo-routing-start form-group\">\\n    <ngeo-routing-feature\\n      ngeo-routing-feature-map=\"$ctrl.map\"\\n      ngeo-routing-feature-feature=\"$ctrl.startFeature_\"\\n      ngeo-routing-feature-fill-color=\"$ctrl.colors[\\'start.fill\\']\"\\n      ngeo-routing-feature-stroke-color=\"$ctrl.colors[\\'start.stroke\\']\"\\n      ngeo-routing-feature-on-change=\"$ctrl.handleChange\">\\n    </ngeo-routing-feature>\\n  </div>\\n\\n    <div class=\"ngeo-routing-vias form-group\" ng-repeat=\"(index, via) in $ctrl.viaArray\">\\n      <div class=\"form-inline\">\\n        <div class=\"form-group\">\\n          <ngeo-routing-feature\\n            ngeo-routing-feature-map=\"$ctrl.map\"\\n            ngeo-routing-feature-feature=\"via.feature\"\\n            ngeo-routing-feature-fill-color=\"$ctrl.colors[\\'via.fill\\']\"\\n            ngeo-routing-feature-stroke-color=\"$ctrl.colors[\\'via.stroke\\']\"\\n            ngeo-routing-feature-on-change=\"$ctrl.handleChange\">\\n          </ngeo-routing-feature>\\n        </div>\\n        <button type=\"button\" class=\"btn btn-default delete-via\" ng-click=\"$ctrl.deleteVia(index)\">\\n          <span class=\"fa fa-trash\"></span>\\n        </button>\\n      </div>\\n    </div>\\n\\n  <div class=\"ngeo-routing-destination form-group\">\\n    <ngeo-routing-feature\\n      ngeo-routing-feature-map=\"$ctrl.map\"\\n      ngeo-routing-feature-feature=\"$ctrl.targetFeature_\"\\n      ngeo-routing-feature-fill-color=\"$ctrl.colors[\\'destination.fill\\']\"\\n      ngeo-routing-feature-stroke-color=\"$ctrl.colors[\\'destination.stroke\\']\"\\n      ngeo-routing-feature-on-change=\"$ctrl.handleChange\">\\n    </ngeo-routing-feature>\\n  </div>\\n\\n  <div class=\"form-group fill\">\\n    <button type=\"button\" class=\"btn btn-default\" ng-click=\"$ctrl.clearRoute()\">\\n      <span class=\"fa fa-trash\"></span> <span translate>Clear</span>\\n    </button>\\n    <button type=\"button\" class=\"btn btn-default\" ng-click=\"$ctrl.reverseRoute()\">\\n      <span class=\"fa fa-exchange-alt\"></span> <span translate>Reverse</span>\\n    </button>\\n    <button type=\"button\" class=\"btn btn-default\" ng-click=\"$ctrl.addVia()\">\\n      <span class=\"fa fa-plus\"></span> <span translate>Add via</span>\\n    </button>\\n  </div>\\n\\n  <div class=\"clearfix\"></div>\\n\\n  <div ng-if=\"$ctrl.routingProfiles.length > 1\">\\n    <div class=\"form-group\">\\n      <label class=\"col-form-label col-md-4\" translate>Profile</label>\\n      <div class=\"col-md-8\">\\n        <select class=\"form-control\" ng-model=\"$ctrl.selectedRoutingProfile\">\\n          <option ng-repeat=\"profile in $ctrl.routingProfiles\" ng-value=\"profile\">{{profile.label}}</option>\\n        </select>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\"ngeo-routing-error form-group clearfix\"\\n       ng-hide=\"$ctrl.errorMessage === \\'\\'\">\\n    {{$ctrl.errorMessage}}\\n  </div>\\n\\n  <div class=\"clearfix\"></div>\\n\\n  <div ng-hide=\"$ctrl.routeDuration === null && $ctrl.routeDistance <= 0\">\\n    <div class=\"row\">\\n      <div class=\"col-md-12\">\\n        <strong translate>Route statistics</strong>\\n      </div>\\n    </div>\\n    <div class=\"row\" ng-hide=\"$ctrl.routeDuration === null\">\\n      <div class=\"col-md-4 text-right\" translate>\\n        Duration\\n      </div>\\n      <div class=\"col-md-8\">\\n        {{$ctrl.routeDuration | ngeoDuration}}\\n      </div>\\n    </div>\\n\\n    <div class=\"row\" ng-hide=\"$ctrl.routeDistance <= 0\">\\n      <div class=\"col-md-4 text-right\" translate>\\n        Distance\\n      </div>\\n      <div class=\"col-md-8\">\\n        {{$ctrl.routeDistance | ngeoUnitPrefix:\\'m\\'}}\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n\n}\nreturn __p\n}","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"ngeo-routing-feature\">\\n    <div class=\"input-group\">\\n      <ngeo-nominatim-input\\n        ngeo-nominatim-input-value=\"$ctrl.featureLabel\"\\n        ngeo-nominatim-input-placeholder=\"{{\\'Search...\\' | translate}}\"\\n        ngeo-nominatim-input-on-select=\"$ctrl.onSelect\">\\n      </ngeo-nominatim-input>\\n      <div class=\"input-group-addon btn\" ng-click=\"$ctrl.set()\">\\n        <span class=\"fa fa-map-marker\"></span>\\n      </div>\\n    </div>\\n</div>\\n';\n\n}\nreturn __p\n}"],"sourceRoot":""}